module.exports=function(e){var r={};function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}return o.m=e,o.c=r,o.d=function(e,r,t){o.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,r){if(1&r&&(e=o(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)o.d(t,a,function(r){return e[r]}.bind(null,a));return t},o.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(r,"a",r),r},o.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},o.p="/dist/",o(o.s=39)}([function(e,r){e.exports=require("mongoose")},function(e,r,o){"use strict";(function(e){var o;(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&o(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const t=e=>{let r;try{let o=e.message.substring(e.message.lastIndexOf(".$")+2,e.message.lastIndexOf("_1"));r=o.charAt(0).toUpperCase()+o.slice(1)+" already exists"}catch(e){r="Unique field already exists"}return r},a=e=>{let r="";if(e.code)switch(e.code){case 11e3:case 11001:r=t(e);break;default:r="Something went wrong"}else for(let o in e.errors)e.errors[o].message&&(r=e.errors[o].message);return r},s={getErrorMessage:a};var d,n;r.a=s,(d="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(d.register(t,"getUniqueErrorMessage","/Users/peterdomokos/projects/demo1/server/helpers/dbErrorHandler.js"),d.register(a,"getErrorMessage","/Users/peterdomokos/projects/demo1/server/helpers/dbErrorHandler.js"),d.register(s,"default","/Users/peterdomokos/projects/demo1/server/helpers/dbErrorHandler.js")),(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&n(e)}).call(this,o(2)(e))},function(e,r){e.exports=function(e){if(!e.webpackPolyfill){var r=Object.create(e);r.children||(r.children=[]),Object.defineProperty(r,"loaded",{enumerable:!0,get:function(){return r.l}}),Object.defineProperty(r,"id",{enumerable:!0,get:function(){return r.i}}),Object.defineProperty(r,"exports",{enumerable:!0}),r.webpackPolyfill=1}return r}},function(e,r,o){"use strict";(function(e){var t,a=o(5),s=o(28),d=o.n(s),n=o(29),l=o.n(n),i=o(6);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const u=async(e,r)=>{console.log("signin......",e.body);try{let o=await a.a.findOne({email:e.body.email}).populate("admin","_id username firstname surname created").populate("administeredUsers","_id username firstname surname photo created").populate({path:"administeredGroups",select:"_id name desc photo groupType created datasets",populate:{path:"datasets",select:"_id name desc"}}).populate({path:"groupsMemberOf",select:"_id name desc photo groupType created datasets",populate:{path:"datasets",select:"_id name desc"}}).populate("administeredDatasets","_id name desc created measures").populate("datasetsMemberOf","_id name desc created");if(!o)return r.status("401").json({error:"User not found"});if(!o.authenticate(e.body.password))return r.status("401").send({error:"Email and password don't match."});const t=d.a.sign({_id:o._id},i.a.jwtSecret);return r.cookie("t",t,{expire:new Date+9999}),r.json({token:t,user:o})}catch(e){return r.status("401").json({error:"Could not sign in"})}},c=(e,r)=>(r.clearCookie("t"),r.status("200").json({message:"signed out"})),p=l()({secret:i.a.jwtSecret,userProperty:"auth"}),f=(e,r,o)=>{const t=e.user&&e.auth&&(e.user._id==e.auth._id||e.user.admin.includes(e.auth._id)||e.user.admin.map(e=>e._id).includes(e.auth._id)||e.auth.isSystemAdmin);if(console.log("authorized???????? ",t),!t)return r.status("403").json({error:"User is not authorized"});o()},m={signin:u,signout:c,requireSignin:p,hasAuthorization:f};var g,y;r.a=m,(g="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(g.register(u,"signin","/Users/peterdomokos/projects/demo1/server/controllers/auth.controller.js"),g.register(c,"signout","/Users/peterdomokos/projects/demo1/server/controllers/auth.controller.js"),g.register(p,"requireSignin","/Users/peterdomokos/projects/demo1/server/controllers/auth.controller.js"),g.register(f,"hasAuthorization","/Users/peterdomokos/projects/demo1/server/controllers/auth.controller.js"),g.register(m,"default","/Users/peterdomokos/projects/demo1/server/controllers/auth.controller.js")),(y="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&y(e)}).call(this,o(2)(e))},function(e,r){e.exports=require("express")},function(e,r,o){"use strict";(function(e){var t,a=o(0),s=o.n(a),d=o(27),n=o.n(d);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const l=new s.a.Schema({username:{type:String,trim:!0,required:"Username is required"},firstname:{type:String,trim:!0,required:"First name is required"},surname:{type:String,trim:!0,required:"Surname is required"},initials:{type:String,trim:!0,required:"User initials are required"},photo:{data:Buffer,contentType:String},email:{type:String,trim:!0,unique:"Email already exists",match:[/.+\@.+\..+/,"Please fill a valid email address"],required:"Email is required"},isPlayer:{type:Boolean,default:!0},isCoach:{type:Boolean,default:!0},admin:[{type:s.a.Schema.ObjectId,ref:"User"}],administeredUsers:[{type:s.a.Schema.ObjectId,ref:"User"}],administeredGroups:[{type:s.a.Schema.ObjectId,ref:"Group"}],administeredDatasets:[{type:s.a.Schema.ObjectId,ref:"Dataset"}],groupsMemberOf:[{type:s.a.Schema.ObjectId,ref:"Group"}],datasetsMemberOf:[{type:s.a.Schema.ObjectId,ref:"Dataset"}],isSystemAdmin:{type:Boolean,default:!1},hashed_password:{type:String,required:"Password is required"},salt:String,updated:Date,created:{type:Date,default:Date.now}});l.virtual("password").set((function(e){this._password=e,this.salt=this.makeSalt(),this.hashed_password=this.encryptPassword(e)})).get((function(){return this._password})),l.path("hashed_password").validate((function(e){this._password&&this._password.length<6&&this.invalidate("password","Password must be at least 6 characters."),this.isNew&&!this._password&&this.invalidate("password","Password is required")}),null),l.methods={authenticate:function(e){return this.encryptPassword(e)===this.hashed_password},encryptPassword:function(e){if(!e)return"";try{return n.a.createHmac("sha1",this.salt).update(e).digest("hex")}catch(e){return""}},makeSalt:function(){return Math.round((new Date).valueOf()*Math.random())+""}};const i=s.a.model("User",l);var u,c;r.a=i,(u="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(u.register(l,"UserSchema","/Users/peterdomokos/projects/demo1/server/models/user.model.js"),u.register(i,"default","/Users/peterdomokos/projects/demo1/server/models/user.model.js")),(c="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&c(e)}).call(this,o(2)(e))},function(e,r,o){"use strict";(function(e){var o;(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&o(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const t={env:"production",port:process.env.PORT||3e3,jwtSecret:process.env.JWT_SECRET||"YOUR_secret_key",mongoUri:process.env.MONGODB_URI||process.env.MONGO_HOST||"mongodb+srv://peterdomokos:3Millbrook@switchplaycluster.l5lum.mongodb.net/switchplay_db?retryWrites=true&w=majority"},a=t;var s,d;r.a=a,(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(s.register(t,"config","/Users/peterdomokos/projects/demo1/config/config.js"),s.register(a,"default","/Users/peterdomokos/projects/demo1/config/config.js")),(d="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&d(e)}).call(this,o(2)(e))},function(e,r,o){"use strict";(function(e){o(43);var t,a=o(14),s=(o(16),o(13)),d=o.n(s),n=o(1),l=o(9),i=o.n(l),u=o(10);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const c=async(e,r)=>{const o=new a.a(e.body);console.log("creating dset",o);try{return await o.save(),console.log("success"),o.admin.forEach(e=>{Object(u.a)(e,"administeredDatasets",o._id)}),r.status(200).json({message:"Successfully created dataset!",dataset:o})}catch(e){return console.log("failure",e),r.status(400).json({error:n.a.getErrorMessage(e)})}},p=async(e,r,o,t)=>{console.log("readdatasetById......",t);try{let s=await a.a.findById(t).populate("admin","_id username firstname surname photo").populate("datapoints.player","_id firstname surname photo");if(!s)return r.status("400").json({error:"Dataset not found"});e.dataset=s,o()}catch(e){return r.status("400").json({error:"Could not retrieve dataset"})}},f=(e,r)=>(console.log("read dataset......"),r.json(e.dataset)),m=async(e,r)=>{console.log("read multiple full datasets......",e.body);try{const o=(await a.a.find().populate("datapoints.player","_id firstname surname photo")).filter(r=>e.body.datasetIds.find(e=>r._id.equals(e)));return o.forEach(r=>{r.datapoints=r.datapoints.filter(r=>r.player._id.equals(e.body.playerId))}),r.json(o)}catch(e){return console.log("error reading multiple datasets......................."),r.status(400).json({error:n.a.getErrorMessage(e)})}},g=async(e,r)=>{try{let e=await a.a.find().select("_id name desc photo datasetType admin created").populate("admin","_id username firstname surname created");console.log("returning datasets now......................."),r.json(e)}catch(e){return console.log("error listing datasets......................."),r.status(400).json({error:n.a.getErrorMessage(e)})}},y=async(e,r)=>{let o=new i.a.IncomingForm;o.keepExtensions=!0,o.parse(e,async(o,t,a)=>{if(console.log("fields",t),o)return r.status(400).json({error:"Photo could not be uploaded"});t.measures=JSON.parse(t.measures),t.calculations=JSON.parse(t.calculations),t.tags=JSON.parse(t.tags);let s=e.dataset;s=d()(s,t),s.updated=Date.now();try{console.log("trying to save...............");const e=await s.save();console.log("returning...........................",e),r.json(e)}catch(o){return r.status(400).json({error:n.a.getErrorMessage(o)})}})},b=async(e,r)=>{console.log("remove dataset..............");try{let o=e.dataset,t=await o.remove();r.json(t)}catch(e){return r.status(400).json({error:n.a.getErrorMessage(e)})}},v=async(e,r)=>{let{dataset:o}=e;const t=e.body;console.log("datapoint player",t.player);const a=o.datapoints.map(e=>e.player);console.log("playersSoFar",a),console.log("already with equals ? ",a.find(e=>e.equals(t.player))),console.log("already with === ? ",a.find(e=>e===t.player)),a.find(e=>e.equals(t.player))||(console.log("adding player to ref................................................."),Object(u.a)(t.player,"datasetsMemberOf",o._id)),o.datapoints.push(t),o.updated=Date.now();try{console.log("trying to save");const e=await o.save(),t=e.datapoints.sort((e,r)=>{const o=new Date(e.created).getTime();return new Date(r.created).getTime()-o})[0];console.log("saved datapoint",t),r.json(t)}catch(e){return r.status(400).json({error:n.a.getErrorMessage(e)})}},h={create:c,datasetByID:p,read:f,readMultiple:m,list:g,remove:b,update:y,createDatapoint:v};var j,G;r.a=h,(j="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(j.register(c,"create","/Users/peterdomokos/projects/demo1/server/controllers/dataset.controller.js"),j.register(p,"datasetByID","/Users/peterdomokos/projects/demo1/server/controllers/dataset.controller.js"),j.register(f,"read","/Users/peterdomokos/projects/demo1/server/controllers/dataset.controller.js"),j.register(m,"readMultiple","/Users/peterdomokos/projects/demo1/server/controllers/dataset.controller.js"),j.register(g,"list","/Users/peterdomokos/projects/demo1/server/controllers/dataset.controller.js"),j.register(y,"update","/Users/peterdomokos/projects/demo1/server/controllers/dataset.controller.js"),j.register(b,"remove","/Users/peterdomokos/projects/demo1/server/controllers/dataset.controller.js"),j.register(v,"createDatapoint","/Users/peterdomokos/projects/demo1/server/controllers/dataset.controller.js"),j.register(h,"default","/Users/peterdomokos/projects/demo1/server/controllers/dataset.controller.js")),(G="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&G(e)}).call(this,o(2)(e))},function(e,r,o){"use strict";(function(e){var t,a=o(0),s=o.n(a);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const d=new s.a.Schema({name:{type:String,trim:!0,required:"Group name is required"},initials:{type:String,trim:!0,required:"Group initials are required"},desc:String,groupType:String,photo:{data:Buffer,contentType:String},admin:[{type:s.a.Schema.ObjectId,ref:"User"}],coaches:[{type:s.a.Schema.ObjectId,ref:"User"}],players:[{type:s.a.Schema.ObjectId,ref:"User"}],datasets:[{type:s.a.Schema.ObjectId,ref:"Dataset"}],updated:Date,created:{type:Date,default:Date.now}}),n=s.a.model("Group",d);var l,i;r.a=n,(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(l.register(d,"GroupSchema","/Users/peterdomokos/projects/demo1/server/models/group.model.js"),l.register(n,"default","/Users/peterdomokos/projects/demo1/server/models/group.model.js")),(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&i(e)}).call(this,o(2)(e))},function(e,r){e.exports=require("formidable")},function(e,r,o){"use strict";(function(e){o.d(r,"a",(function(){return n})),o.d(r,"b",(function(){return c}));o(9),o(41),o(42);var t,a=o(1),s=o(8),d=o(5);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const n=(e,r,o)=>{d.a.findByIdAndUpdate(e,{$push:{[r]:o}},(e,o)=>{e?console.log("ERROR: add "+r+" ref to user error:",a.a.getErrorMessage(e)):console.log("SUCCESS: added "+r+" ref to user")})},l=(e,r,o)=>{s.a.findByIdAndUpdate(e,{$push:{[r]:o}},(e,o)=>{e?console.log("ERROR: add "+r+" ref to group error:",a.a.getErrorMessage(e)):console.log("SUCCESS: added "+r+" ref to group")})},i=(e,r,o)=>{d.a.findByIdAndUpdate(e,{$set:{[r]:o}},(e,o)=>{e?console.log("ERROR: set "+r+" ref in user error:",a.a.getErrorMessage(e)):console.log("SUCCESS: set "+r+" ref in user")})},u=(e,r,o)=>{s.a.findByIdAndUpdate(e,{$set:{[r]:o}},(e,o)=>{e?console.log("ERROR: set "+r+" ref in group error:",a.a.getErrorMessage(e)):console.log("SUCCESS: set "+r+" ref in group")})},c=(e,r,o)=>{d.a.findByIdAndUpdate(e,{$pull:{[r]:o}},(e,o)=>{e?console.log("ERROR: remove "+r+" ref from user error:",a.a.getErrorMessage(e)):console.log("SUCCESS: removed "+r+" ref from user")})},p=(e,r,o)=>{s.a.findByIdAndUpdate(e,{$pull:{[r]:o}},(e,o)=>{e?console.log("ERROR: remove "+r+" ref from group error:",a.a.getErrorMessage(e)):console.log("SUCCESS: removed "+r+" ref from group")})};var f,m;(f="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(f.register(n,"addRefToUserArray","/Users/peterdomokos/projects/demo1/server/helpers/dbQueries.js"),f.register(l,"addRefToGroupArray","/Users/peterdomokos/projects/demo1/server/helpers/dbQueries.js"),f.register(i,"setRefInUser","/Users/peterdomokos/projects/demo1/server/helpers/dbQueries.js"),f.register(u,"setRefInGroup","/Users/peterdomokos/projects/demo1/server/helpers/dbQueries.js"),f.register(c,"removeRefFromUserArray","/Users/peterdomokos/projects/demo1/server/helpers/dbQueries.js"),f.register(p,"removeRefFromGroupArray","/Users/peterdomokos/projects/demo1/server/helpers/dbQueries.js")),(m="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&m(e)}).call(this,o(2)(e))},function(e,r,o){"use strict";(function(e){var t,a=o(5),s=o(13),d=o.n(s),n=o(1),l=o(9),i=o.n(l);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const u=async(e,r)=>{const o=new a.a(e.body);console.log("created",o);try{return console.log("trying"),await o.save(),console.log("success"),r.status(200).json({mesg:"Successfully signed up!",user:o})}catch(e){return console.log("failure",e),r.status(400).json({error:n.a.getErrorMessage(e)})}},c=async(e,r,o,t)=>{console.log("readuserById......",t);try{let s=await a.a.findById(t).populate("admin","_id username firstname surname created").populate("administeredUsers","_id username firstname surname photo created").populate({path:"administeredGroups",select:"_id name desc photo groupType created datasets",populate:{path:"datasets",select:"_id name desc"}}).populate({path:"groupsMemberOf",select:"_id name desc photo groupType created datasets",populate:{path:"datasets",select:"_id name desc"}}).populate("administeredDatasets","_id name desc notes photo admin created").populate("datasetsMemberOf","_id name desc notes photo admin created");if(!s)return r.status("400").json({error:"User not found"});e.user=s,o()}catch(e){return r.status("400").json({error:"Could not retrieve user"})}},p=(e,r)=>(console.log("read......"),e.user.hashed_password=void 0,e.user.salt=void 0,r.json(e.user)),f=async(e,r)=>{try{let e=await a.a.find().select("username firstname surname photo email updated created admin").populate("admin","_id username firstname surname created");r.json(e)}catch(e){return console.log("error listing users......................."),r.status(400).json({error:n.a.getErrorMessage(e)})}},m=async(e,r)=>{console.log("updating user....................");let o=new i.a.IncomingForm;o.keepExtensions=!0,o.parse(e,async(o,t,a)=>{if(o)return r.status(400).json({error:"Photo could not be uploaded"});t.admin=JSON.parse(t.admin);let s=e.user;s=d()(s,t),s.updated=Date.now(),console.log("user now",s),a.photo&&(s.photo.data=fs.readFileSync(a.photo.path),s.photo.contentType=a.photo.type);try{await s.save(),s.hashed_password=void 0,s.salt=void 0,r.json(s)}catch(o){return r.status(400).json({error:n.a.getErrorMessage(o)})}})},g=async(e,r)=>{console.log("remove user..............");try{let o=e.user,t=await o.remove();t.hashed_password=void 0,t.salt=void 0,r.json(t)}catch(e){return r.status(400).json({error:n.a.getErrorMessage(e)})}},y={create:u,userByID:c,read:p,list:f,remove:g,update:m};var b,v;r.a=y,(b="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(b.register(u,"create","/Users/peterdomokos/projects/demo1/server/controllers/user.controller.js"),b.register(c,"userByID","/Users/peterdomokos/projects/demo1/server/controllers/user.controller.js"),b.register(p,"read","/Users/peterdomokos/projects/demo1/server/controllers/user.controller.js"),b.register(f,"list","/Users/peterdomokos/projects/demo1/server/controllers/user.controller.js"),b.register(m,"update","/Users/peterdomokos/projects/demo1/server/controllers/user.controller.js"),b.register(g,"remove","/Users/peterdomokos/projects/demo1/server/controllers/user.controller.js"),b.register(y,"default","/Users/peterdomokos/projects/demo1/server/controllers/user.controller.js")),(v="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&v(e)}).call(this,o(2)(e))},function(e,r,o){"use strict";(function(e){var t,a=o(8),s=o(13),d=o.n(s),n=o(1),l=o(9),i=o.n(l),u=o(10);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const c=async(e,r)=>{console.log("createGroup");const o=new a.a(e.body);console.log("creating group",o);try{return await o.save(),console.log("success"),o.admin.forEach(e=>{Object(u.a)(e,"administeredGroups",o._id)}),r.status(200).json({message:"Successfully created group!",group:o})}catch(e){return console.log("failure",e),r.status(400).json({error:n.a.getErrorMessage(e)})}},p=async(e,r,o,t)=>{console.log("readgroupById......",t);try{let s=await a.a.findById(t).populate("admin","_id username firstname surname photo").populate("players","_id username firstname surname photo").populate("datasets","_id name desc photo");if(console.log("group",s),!s)return r.status("400").json({error:"Group not found"});e.group=s,o()}catch(e){return r.status("400").json({error:"Could not retrieve group"})}},f=(e,r)=>(console.log("read group......"),r.json(e.group)),m=async(e,r)=>{try{let e=await a.a.find().select("_id name desc photo groupType admin created").populate("admin","_id username firstname surname created");console.log("returning groups now......................."),r.json(e)}catch(e){return console.log("error listing groups......................."),r.status(400).json({error:n.a.getErrorMessage(e)})}},g=async(e,r)=>{console.log("updating group....................");let o=new i.a.IncomingForm;o.keepExtensions=!0,o.parse(e,async(o,t,a)=>{if(console.log("fields",t),o)return r.status(400).json({error:"Photo could not be uploaded"});"string"==typeof t.players&&(t.players=""===t.players?[]:t.players.split(",")),"string"==typeof t.datasets&&(t.datasets=""===t.datasets?[]:t.datasets.split(",")),console.log("fields players",t.players);let s=e.group;if(console.log("group.players",s.players),t.players){const e=t.players.filter(e=>!s.players.find(r=>r.equals(e)));console.log("nr of added players",e.length),e.forEach(e=>{Object(u.a)(e,"groupsMemberOf",s._id)});const r=s.players.filter(e=>!t.players.find(r=>r.equals(e)));console.log("nr of removed players",r.length),r.forEach(e=>{Object(u.b)(e,"groupsMemberOf",s._id)})}s=d()(s,t),s.updated=Date.now(),console.log("group now.................",s),a.photo&&(s.photo.data=fs.readFileSync(a.photo.path),s.photo.contentType=a.photo.type);try{await s.save(),r.json(s)}catch(o){return r.status(400).json({error:n.a.getErrorMessage(o)})}})},y=async(e,r)=>{console.log("remove group..............");try{let o=e.group,t=await o.remove();r.json(t)}catch(e){return r.status(400).json({error:n.a.getErrorMessage(e)})}},b={create:c,groupByID:p,read:f,list:m,remove:y,update:g};var v,h;r.a=b,(v="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(v.register(c,"create","/Users/peterdomokos/projects/demo1/server/controllers/group.controller.js"),v.register(p,"groupByID","/Users/peterdomokos/projects/demo1/server/controllers/group.controller.js"),v.register(f,"read","/Users/peterdomokos/projects/demo1/server/controllers/group.controller.js"),v.register(m,"list","/Users/peterdomokos/projects/demo1/server/controllers/group.controller.js"),v.register(g,"update","/Users/peterdomokos/projects/demo1/server/controllers/group.controller.js"),v.register(y,"remove","/Users/peterdomokos/projects/demo1/server/controllers/group.controller.js"),v.register(b,"default","/Users/peterdomokos/projects/demo1/server/controllers/group.controller.js")),(h="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&h(e)}).call(this,o(2)(e))},function(e,r){e.exports=require("lodash/extend")},function(e,r,o){"use strict";(function(e){var t,a=o(0),s=o.n(a),d=o(16),n=o(33),l=o(34);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const i=new s.a.Schema({name:{type:String,trim:!0,required:"Dataset name is required"},initials:{type:String,trim:!0,required:"Dataset initials is required"},desc:String,notes:String,photo:{data:Buffer,contentType:String},admin:[{type:s.a.Schema.ObjectId,ref:"User"}],measures:[{type:n.a}],calculations:[{type:l.a}],mainValueToDisplay:String,datapoints:[{type:d.a}],notes:{type:String,default:""},tags:[String],updated:Date,created:{type:Date,default:Date.now}}),u=s.a.model("Dataset",i);var c,p;r.a=u,(c="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(c.register(i,"DatasetSchema","/Users/peterdomokos/projects/demo1/server/models/dataset.model.js"),c.register(u,"default","/Users/peterdomokos/projects/demo1/server/models/dataset.model.js")),(p="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&p(e)}).call(this,o(2)(e))},function(e,r){e.exports=require("path")},function(e,r,o){"use strict";(function(e){var t,a=o(0),s=o.n(a),d=o(32);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const n=new s.a.Schema({player:{type:s.a.Schema.ObjectId,ref:"User"},players:[{type:s.a.Schema.ObjectId,ref:"User"}],createdBy:{type:s.a.Schema.ObjectId,ref:"User"},date:{type:Date,default:Date.now},created:{type:Date,default:Date.now},values:[d.a],notes:{type:String,default:""},surface:String,fatigueLevel:String,isTarget:Boolean,updated:Date});var l,i;r.a=n,(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&l.register(n,"default","/Users/peterdomokos/projects/demo1/server/models/datapoint.model.js"),(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&i(e)}).call(this,o(2)(e))},function(e,r){e.exports=require("webpack")},function(e,r){e.exports=require("body-parser")},function(e,r,o){(function(e){var r;(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const t=o(15),a=o(17),s=process.cwd(),d={name:"browser",mode:"development",devtool:"eval-source-map",entry:["webpack-hot-middleware/client?reload=true",t.join(s,"client/main.js")],output:{path:t.join(s,"/dist"),filename:"bundle.js",publicPath:"/dist/"},module:{rules:[{test:/\.jsx?$/,exclude:/node_modules/,use:["babel-loader"]},{test:/\.(ttf|eot|svg|gif|jpg|png)(\?[\s\S]+)?$/,use:"file-loader"},{test:/\.css$/,use:["style-loader",{loader:"css-loader",options:{modules:!1}},{loader:"postcss-loader",options:{plugin:()=>[o(45)]}}]}]},plugins:[new a.HotModuleReplacementPlugin,new a.NoEmitOnErrorsPlugin],resolve:{alias:{"react-dom":"@hot-loader/react-dom"}}};var n,l;e.exports=d,(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(n.register(s,"CURRENT_WORKING_DIR","/Users/peterdomokos/projects/demo1/webpack.config.client.js"),n.register(d,"config","/Users/peterdomokos/projects/demo1/webpack.config.client.js")),(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&l(e)}).call(this,o(44)(e))},function(e,r,o){"use strict";(function(e){var t,a=o(4),s=o.n(a),d=o(15),n=o.n(d),l=o(18),i=o.n(l),u=o(21),c=o.n(u),p=o(22),f=o.n(p),m=o(23),g=o.n(m),y=o(24),b=o.n(y),v=o(25),h=o(26),j=o(30),G=o(31),H=o(35),L=o(36);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const S=process.cwd(),U=s()();L.a.compile(U),U.use(s.a.static("assets")),U.use(i.a.json()),U.use(i.a.urlencoded({extended:!0})),U.use(c()()),U.use(f()()),U.use(b()()),U.use(g()()),U.use("/dist",s.a.static(n.a.join(S,"dist"))),U.use("/",h.a),U.use("/",j.a),U.use("/",G.a),U.use("/",H.a),U.get("*",(e,r)=>{r.status(200).send(Object(v.a)())});const w=U;var k,M;r.a=w,(k="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(k.register(S,"CURRENT_WORKING_DIR","/Users/peterdomokos/projects/demo1/server/express.js"),k.register(U,"app","/Users/peterdomokos/projects/demo1/server/express.js"),k.register(w,"default","/Users/peterdomokos/projects/demo1/server/express.js")),(M="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&M(e)}).call(this,o(2)(e))},function(e,r){e.exports=require("cookie-parser")},function(e,r){e.exports=require("compression")},function(e,r){e.exports=require("cors")},function(e,r){e.exports=require("helmet")},function(e,r,o){"use strict";(function(e){var o;(o="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&o(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const t=()=>'<!doctype html>\n    <html lang="en">\n      <head>\n        <meta name="viewport" content="minimum-scale=1, initial-scale=1, width=device-width, shrink-to-fit=no" charset="utf-8">\n        <title>Switchplay</title>\n        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400">\n        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">\n        <style>\n            a{\n              text-decoration: none;\n              color: #061d95\n            }\n        </style>\n      </head>\n      <body>\n        <div id="root"></div>\n        <script type="text/javascript" src="/dist/bundle.js"><\/script>\n      </body>\n    </html>';var a,s;r.a=t,(a="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&a.register(t,"default","/Users/peterdomokos/projects/demo1/template.js"),(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&s(e)}).call(this,o(2)(e))},function(e,r,o){"use strict";(function(e){var t,a=o(4),s=o.n(a),d=o(11),n=o(3);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const l=s.a.Router();l.route("/api/users").get(d.a.list).post(d.a.create),l.route("/api/users/:userId").get(n.a.requireSignin,d.a.read).put(n.a.requireSignin,n.a.hasAuthorization,d.a.update).delete(n.a.requireSignin,n.a.hasAuthorization,d.a.remove),l.param("userId",d.a.userByID);const i=l;var u,c;r.a=i,(u="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(u.register(l,"router","/Users/peterdomokos/projects/demo1/server/routes/user.routes.js"),u.register(i,"default","/Users/peterdomokos/projects/demo1/server/routes/user.routes.js")),(c="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&c(e)}).call(this,o(2)(e))},function(e,r){e.exports=require("crypto")},function(e,r){e.exports=require("jsonwebtoken")},function(e,r){e.exports=require("express-jwt")},function(e,r,o){"use strict";(function(e){var t,a=o(4),s=o.n(a),d=o(12),n=o(3);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const l=s.a.Router();l.route("/api/groups").get(d.a.list).post(d.a.create),l.route("/api/groups/:groupId").get(n.a.requireSignin,d.a.read).put(n.a.requireSignin,d.a.update).delete(n.a.requireSignin,n.a.hasAuthorization,d.a.remove),l.param("groupId",d.a.groupByID);const i=l;var u,c;r.a=i,(u="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(u.register(l,"router","/Users/peterdomokos/projects/demo1/server/routes/group.routes.js"),u.register(i,"default","/Users/peterdomokos/projects/demo1/server/routes/group.routes.js")),(c="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&c(e)}).call(this,o(2)(e))},function(e,r,o){"use strict";(function(e){var t,a=o(4),s=o.n(a),d=o(7),n=o(3);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const l=s.a.Router();l.route("/api/datasets").get(d.a.list).post(d.a.create),l.route("/api/datasets/multiple").put(d.a.readMultiple),l.route("/api/datasets/:datasetId/datapoints/create").put(d.a.createDatapoint),l.route("/api/datasets/:datasetId").get(n.a.requireSignin,d.a.read).put(n.a.requireSignin,d.a.update).delete(n.a.requireSignin,n.a.hasAuthorization,d.a.remove),l.param("datasetId",d.a.datasetByID);const i=l;var u,c;r.a=i,(u="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(u.register(l,"router","/Users/peterdomokos/projects/demo1/server/routes/dataset.routes.js"),u.register(i,"default","/Users/peterdomokos/projects/demo1/server/routes/dataset.routes.js")),(c="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&c(e)}).call(this,o(2)(e))},function(e,r,o){"use strict";(function(e){var t,a=o(0),s=o.n(a);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const d=new s.a.Schema({measure:{type:s.a.Schema.ObjectId,ref:"Measure"},value:{type:String,required:"Value is required"}});var n,l;r.a=d,(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&n.register(d,"default","/Users/peterdomokos/projects/demo1/server/models/value.model.js"),(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&l(e)}).call(this,o(2)(e))},function(e,r,o){"use strict";(function(e){var t,a=o(0),s=o.n(a);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const d=new s.a.Schema({name:{type:String,required:"Name is required"},initials:{type:String,required:"initials are required"},key:{type:String,required:"Key is required"},nr:String,side:String,custom:String,order:{type:String,default:"highest is best"},unit:String,dataType:{type:String,default:"number"},formula:String,notes:String,hidden:{type:Boolean,default:!1},isMain:{type:Boolean,default:!1},createdBy:{type:s.a.Schema.ObjectId,ref:"User"}});var n,l;r.a=d,(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&n.register(d,"default","/Users/peterdomokos/projects/demo1/server/models/dataset-measure.model.js"),(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&l(e)}).call(this,o(2)(e))},function(e,r,o){"use strict";(function(e){var t,a=o(0),s=o.n(a);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const d=new s.a.Schema({name:{type:String,required:"Name is required"},initials:{type:String,required:"initials are required"},key:{type:String,required:"Key is required"},dataType:{type:String,default:"number"},formula:String,unit:String,isMain:Boolean,createdBy:{type:s.a.Schema.ObjectId,ref:"User"}});var n,l;r.a=d,(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&n.register(d,"default","/Users/peterdomokos/projects/demo1/server/models/calculation.model.js"),(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&l(e)}).call(this,o(2)(e))},function(e,r,o){"use strict";(function(e){var t,a=o(4),s=o.n(a),d=o(3);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const n=s.a.Router();n.route("/auth/signin").post(d.a.signin),n.route("/auth/signout").get(d.a.signout);const l=n;var i,u;r.a=l,(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(i.register(n,"router","/Users/peterdomokos/projects/demo1/server/routes/auth.routes.js"),i.register(l,"default","/Users/peterdomokos/projects/demo1/server/routes/auth.routes.js")),(u="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&u(e)}).call(this,o(2)(e))},function(e,r,o){"use strict";(function(e){var t,a=o(6),s=o(17),d=o.n(s),n=o(37),l=o.n(n),i=o(38),u=o.n(i),c=o(19),p=o.n(c);(t="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&t(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const f=e=>{if("development"===a.a.env){const r=d()(p.a),o=l()(r,{publicPath:p.a.output.publicPath});e.use(o),e.use(u()(r))}},m={compile:f};var g,y;r.a=m,(g="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(g.register(f,"compile","/Users/peterdomokos/projects/demo1/server/devBundle.js"),g.register(m,"default","/Users/peterdomokos/projects/demo1/server/devBundle.js")),(y="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&y(e)}).call(this,o(2)(e))},function(e,r){e.exports=require("webpack-dev-middleware")},function(e,r){e.exports=require("webpack-hot-middleware")},function(e,r,o){e.exports=o(40)},function(e,r,o){"use strict";o.r(r);var t=o(6),a=o(20),s=o(0),d=o.n(s);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;d.a.Promise=global.Promise,d.a.connect(t.a.mongoUri,{useNewUrlParser:!0,useCreateIndex:!0,useUnifiedTopology:!0}),a.a.listen(t.a.port,e=>{e&&console.log(e),console.info("Server started on port %s.",t.a.port)})},function(e,r){e.exports=require("fs")},function(e,r){e.exports=require("lodash")},function(e,r){e.exports=require("d3")},function(e,r){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,r){e.exports=require("autoprefixer")}]);